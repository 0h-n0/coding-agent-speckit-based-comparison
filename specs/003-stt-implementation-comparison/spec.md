# Feature Specification: STT Implementation Comparison

**Feature Branch**: `003-stt-implementation-comparison`
**Created**: 2025-12-26
**Status**: Draft
**Input**: User description: "それぞれのsubmoduleのspec/*stt*にかんする実装を比較してください。また、SPECの比較とその実装の比較もスクリプトを確認してください"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - View STT Specification Comparison Online (Priority: P1)

プロジェクト評価者として、3つのエージェント（Codex, Gemini, Claude）のSTT仕様書の違いをドキュメントサイトで閲覧したい。各エージェントがSTT機能をどのように定義しているか、機能要件、成功基準、エンドポイント設計の違いを一目で比較できるようにする。

**Why this priority**: 仕様書の比較は実装比較の前提条件であり、各エージェントの設計思想の違いを理解するための基盤となる。

**Independent Test**: ドキュメントサイトで `/methodology/stt-comparison/` にアクセスし、3つのエージェントのSTT仕様の比較表が表示されることを確認する。

**Acceptance Scenarios**:

1. **Given** ドキュメントサイトが表示されている, **When** STT比較ページにアクセス, **Then** 3つのエージェントのSTT仕様が表形式で比較表示される
2. **Given** 比較ページが表示されている, **When** 機能要件セクションを確認, **Then** 各エージェントの FR-001〜FR-XXX が対照表で表示される
3. **Given** 比較ページが表示されている, **When** 成功基準セクションを確認, **Then** レイテンシ目標、精度目標などの数値が比較表示される

---

### User Story 2 - View STT Implementation Comparison (Priority: P1)

開発者として、3つのエージェントのSTT実装コードの違いをドキュメントサイトで確認したい。APIエンドポイント設計、エラーハンドリング、WebSocket実装、テストコードの違いを理解し、各エージェントの実装品質を評価できるようにする。

**Why this priority**: 仕様書だけでなく実際の実装を比較することで、各エージェントの開発能力を客観的に評価できる。

**Independent Test**: ドキュメントサイトで実装比較セクションにアクセスし、コード構造、ファイル数、テストカバレッジなどの比較データが表示されることを確認する。

**Acceptance Scenarios**:

1. **Given** 実装比較セクションが表示されている, **When** ファイル構造を確認, **Then** 各エージェントのSTT関連ファイル一覧と行数が表示される
2. **Given** 実装比較セクションが表示されている, **When** API設計を確認, **Then** エンドポイントパス、パラメータ、レスポンス形式の違いが表示される
3. **Given** 実装比較セクションが表示されている, **When** テストを確認, **Then** 各エージェントのテストファイル数とテストケース数が表示される

---

### User Story 3 - Understand Spec-to-Implementation Alignment (Priority: P2)

プロジェクトマネージャーとして、各エージェントがSTT仕様書をどの程度忠実に実装しているかを評価したい。仕様書で定義された要件と実際の実装の対応関係を確認し、各エージェントの「仕様遵守度」を判断できるようにする。

**Why this priority**: 仕様と実装の整合性は、エージェントの開発プロセス品質を測る重要な指標である。

**Independent Test**: 仕様遵守度セクションで、各エージェントの要件達成状況（実装済み/未実装/部分的）がチェックリスト形式で表示されることを確認する。

**Acceptance Scenarios**:

1. **Given** 仕様遵守度セクションが表示されている, **When** Codexの達成状況を確認, **Then** 各機能要件に対する実装状況（✅/⚠️/❌）が表示される
2. **Given** 仕様遵守度セクションが表示されている, **When** 全エージェントを比較, **Then** 達成率（%）が一覧表示される

---

### Edge Cases

- submoduleが最新状態でない場合、比較結果が古い可能性がある → 比較日時とコミットハッシュを明記
- 一部のエージェントにSTT機能がない場合 → 「未実装」として扱う
- 仕様書と実装のファイル名が異なる命名規則の場合 → マッピングテーブルで対応

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは3つのエージェント（Codex, Gemini, Claude）のSTT仕様書を比較する分析ページを提供しなければならない
- **FR-002**: システムは各エージェントのSTT仕様書のバージョン（コミットハッシュ）を追跡可能な形で表示しなければならない
- **FR-003**: システムは機能要件（FR）の対照表を提供し、各エージェントの要件定義の違いを可視化しなければならない
- **FR-004**: システムは成功基準（SC）の比較表を提供し、パフォーマンス目標の違いを数値で比較できなければならない
- **FR-005**: システムは各エージェントのSTT実装コードの構造比較を提供しなければならない
- **FR-006**: システムはAPIエンドポイント設計の比較表（パス、メソッド、パラメータ）を提供しなければならない
- **FR-007**: システムはWebSocket実装の有無と設計の違いを比較しなければならない
- **FR-008**: システムはエラーハンドリングパターンの比較を提供しなければならない
- **FR-009**: システムはテストコードの比較（テストファイル数、テストケース数、テストタイプ）を提供しなければならない
- **FR-010**: システムは仕様書の各要件に対する実装状況のチェックリストを提供しなければならない（評価はClaude Codeを用いたLLMベース分析で実施）
- **FR-011**: ドキュメントサイトは `mkdocs build --strict` で正常にビルドできなければならない

### Key Entities

- **STTSpecification**: 各エージェントのSTT仕様書データ（機能要件リスト、成功基準、ユーザーストーリー）
- **STTImplementation**: 各エージェントのSTT実装データ（ファイルパス、行数、エンドポイント、テスト情報）
- **ComparisonResult**: 比較分析結果（比較日時、コミット参照、カテゴリ別評価）
- **AlignmentCheck**: 仕様-実装整合性チェック結果（要件ID、実装状況、エビデンス）

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 比較ページが3つのエージェントすべてのSTT仕様を網羅的に表示できる
- **SC-002**: 各エージェントの比較データにはコミットハッシュへのリンクが含まれ、追跡可能である
- **SC-003**: 実装比較では少なくとも5つの比較カテゴリ（ファイル構造、API設計、エラー処理、WebSocket、テスト）が含まれる
- **SC-004**: 仕様遵守度は各エージェントの全機能要件に対する達成率として算出される
- **SC-005**: ドキュメントサイトが `mkdocs build --strict` で警告なしにビルド成功する

## Clarifications

### Session 2025-12-26

- Q: 仕様遵守度の評価はどのように行いますか？ → A: LLMベース評価（Claude Codeで各FRと実装を照合）

## Assumptions

- submoduleは最新のmainブランチを追跡している
- 各エージェントのリポジトリにはSTT関連のスペックと実装が存在する
- 比較は2025-12-26時点のコミットに基づく
- ドキュメントはMkDocs + Material for MkDocsテーマで構築される
